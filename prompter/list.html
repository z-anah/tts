<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Prompt Engineering - List</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'media'
    }
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <link href="../styles.css" rel="stylesheet">
  <script src="shared.js"></script>
</head>

<body class="bg-gray-50 dark:bg-gray-900">

  <div id="app" class="min-h-screen flex flex-col">

    <div id="header-container"></div>

    <main class="flex-1 p-4">
      <!-- List View -->
      <section class="max-w-6xl mx-auto">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-2xl font-bold dark:text-white">All Prompts</h2>
          <button @click="fetchPrompts" class="p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700">
            <span class="material-symbols-outlined dark:text-white">refresh</span>
          </button>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          <div v-for="prompt in prompts" :key="prompt.id" @click="viewPrompt(prompt)"
            class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer">
            <div class="flex justify-between items-start mb-3">
              <div class="flex-1">
                <p class="font-semibold text-sm dark:text-white">{{ prompt.title }}</p>
              </div>
              <div class="flex gap-1 ml-2">
                <button @click.stop="viewPrompt(prompt)" class="p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700">
                  <span class="material-symbols-outlined text-sm dark:text-white">visibility</span>
                </button>
                <button @click.stop="editPrompt(prompt)" class="p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700">
                  <span class="material-symbols-outlined text-sm dark:text-white">edit</span>
                </button>
                <button @click.stop="deletePrompt(prompt.id)"
                  class="p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700">
                  <span class="material-symbols-outlined text-sm text-red-600 dark:text-red-400">delete</span>
                </button>
              </div>
            </div>
            <p class="text-xs text-gray-500 dark:text-gray-400">
              {{ prompt.contents?.length || 0 }} content(s) â€¢ ID: {{ prompt.id }}
            </p>
          </div>
        </div>

        <div v-if="!prompts.length" class="text-center text-gray-500 dark:text-gray-400 mt-10">
          No prompts yet. Create your first prompt!
        </div>
      </section>
    </main>

  </div>

  <script>
    Vue.createApp({
      data() {
        return {
          prompts: []
        }
      },
      async mounted() {
        // Set up header
        document.getElementById('header-container').innerHTML = createHeader('list');
        
        // Fetch prompts
        await this.fetchPrompts();
      },
      methods: {
        async fetchPrompts() {
          this.prompts = await PrompterAPI.fetchAll();
        },

        viewPrompt(prompt) {
          PrompterNav.goToDetail(prompt.id);
        },

        editPrompt(prompt) {
          PrompterNav.goToEdit(prompt.id);
        },

        async deletePrompt(id) {
          if (confirm('Are you sure you want to delete this prompt?')) {
            await PrompterAPI.delete(id);
            this.prompts = this.prompts.filter(p => p.id !== id);
          }
        }
      }
    }).mount('#app');
  </script>
  <script src="../auto-resize.js"></script>
</body>

</html>